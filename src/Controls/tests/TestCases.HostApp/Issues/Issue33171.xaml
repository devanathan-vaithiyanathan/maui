<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Maui.Controls.Sample.Issues.Issue33171"
             Title="Issue 33171 - TitleBar caption buttons unresponsive when IsVisible=false">

    <ScrollView>
        <StackLayout Padding="20" Spacing="15">
            <Label Text="When TitleBar.IsVisible = false, caption buttons become unresponsive at certain window widths"
                   FontSize="16"
                   HorizontalOptions="Center"
                   HorizontalTextAlignment="Center"/>
            
            <Label x:Name="StatusLabel"
                   AutomationId="StatusLabel"
                   Text="TitleBar is currently visible"
                   FontSize="14"
                   HorizontalOptions="Center"
                   BackgroundColor="LightGray"
                   Padding="10"/>

            <Button x:Name="ToggleTitleBarButton"
                    AutomationId="ToggleTitleBarButton"
                    Text="Hide TitleBar (Set IsVisible = false)"
                    Clicked="OnToggleTitleBarClicked"
                    HorizontalOptions="Center"/>

            <Button x:Name="ResizeWindowButton"
                    AutomationId="ResizeWindowButton"
                    Text="Resize Window (Trigger Issue)"
                    Clicked="OnResizeWindowClicked"
                    HorizontalOptions="Center"/>

            <StackLayout x:Name="InstructionsPanel" 
                         AutomationId="InstructionsPanel"
                         IsVisible="False"
                         BackgroundColor="LightYellow"
                         Padding="15"
                         Spacing="10">
                <Label Text="Instructions to reproduce:"
                       FontWeight="Bold"/>
                <Label Text="1. Click 'Hide TitleBar' button"/>
                <Label Text="2. Click 'Resize Window' button to trigger width changes"/>
                <Label Text="3. Try clicking the caption buttons (minimize, maximize, close)"/>
                <Label Text="4. Caption buttons should be responsive but may become unresponsive at certain widths"/>
            </StackLayout>

            <Button x:Name="ShowInstructionsButton"
                    AutomationId="ShowInstructionsButton"
                    Text="Show Instructions"
                    Clicked="OnShowInstructionsClicked"
                    HorizontalOptions="Center"/>

            <Label x:Name="TestResultLabel"
                   AutomationId="TestResultLabel"
                   Text="Test Status: Ready"
                   FontSize="14"
                   HorizontalOptions="Center"
                   BackgroundColor="LightBlue"
                   Padding="10"/>
        </StackLayout>
    </ScrollView>
</ContentPage>